IAMは無料で使うことができる。

AWSリソースへのアクセスを安全に管理するためのサービス。

`**AWSリソース**`っていうのは、**ユーザが操作できるもの**を指す

メールアドレスとパスワードによって、`ルートアカウント`でログインしてると思うが、**まずこのルートアカウントでのログインは公式で推奨していない。**

最も重要なのは、ユーザー、グループ、ロール、ポリシーについての理解になります。

セキュリティでとても重要な認証/認可の部分になるため、アカウント管理をされる方にはとても重要なサービスです。

- AWSアカウント内のユーザを作成
- AWSリソースへのAWSリソースへのアクセス権限を管理
- リソース間のアクセス権限をアクセス権限を管理
- 一時的なアクセスを許可

IAMユーザーにも****多要素認証（MFA）を設定した方がよい。****

### ●IAMポリシー

実行者( ユーザ、ロール、グループ)が、どのサービスにアクセスできるのか、決まりごとを設定する機能。**JSON形式**。

複数のポリシーを設定可能。

記述方法

```jsx
{
  "Version": "2012-10-17",　ポリシーの記述言語のバージョン(すべて2012-10-17になっている)
  "id": "S3-Access-Policy", ポリシーの識別子(ユーザが独自に設定)。必須ではない。
  "Statement": [            この中にこの中にポリシーを記述。宣言文。
    {
      "Sid": "1",           Statementの識別子(ユーザが独自に設定) Statement Idの略
      "Effect": "Allow",    アクセス権限を許可、拒否で設定 Allow or Deny
      "Principal": {        適用するアカウント、ユーザ、ロールを設定
        "Service": "personalize.amazonaws.com"
      },
      "Action": "s3:GetObject",   特定リソースに対して許可or拒否するアクション リソース名:~
      "Resource": "arn:aws:s3:::your-bucket-name/*",  アクションの設定対象となるリソースの一覧
      "Condition" : {             ポリシー適用ポリシー適用対象を絞るための絞るための追加条件
      "NotIpAddress" : {
         "aws:SourceIp": [
           "192.0.2.0/24",
           "203.0.113.0/24"
         ]
       }
      }
    }
  ]
}
```

ポリシーのタイプ ※IAMポリシーはユーザベースのポリシー

1. IAMポリシーのタイプ
- **管理ポリシー 使い回しできる**

      1. **AWS管理ポリシー** : AWSが作成および管理しているIAMIAM管理ポリシー。すでにAWSが設定しているポリシーがリスト化されており、適時ユーザやロールが適用できる。

      2. **カスタマーポリシー** : AWSアカウントで作成・管理する管理ポリシー。同じポリシーを複封のIAMエンティティにアタッチできる ⇒ **自作ポリシー**

- **インラインポリシー**  **使い回しできない**

      : 1つのプリンシパルエンティティ(ユーザ、グループまたはロール)に組み込まれた固有ポリシー(=使い回しできない)で、プリンシパルエンティティにアタッチすることができる。

1. リソースベースポリシーのタイプ

AWSリソースにアタックされるポリシーであり、リソースに対する対するアクセス権限権限設定を実行する

JSON形式JSON形式のドキュメントドキュメントで定義されたインラインポリシーをリソースにアタッチして利用する

ポリシー効果

許可ポリシー : 権限を許可するポリシー

信頼ポリシー : 相手を信頼する時に付与するポリシー。ロールで作成する。

信頼ポリシーがフォよされたものに対して許可ポリシーを設定できる

Permission boundary(権限境界) ⚠️権限を与えるわけではない

IAMユーザに対してアクセスできる権限境界をあらかじめ制限できる

### ●IAMロール　⚠️AWSサービスだけでなく、ユーザに対しても付与できる

**特定のAWSサービスAに対して、別のAWSサービスBへのアクセスを許可するために設定するもの。Aにロールを付与する。**

**別のAWSアカウントのIAMユーザにアクセス権限を譲る際にも利用される**

信頼されたエンティティが許可先のリソースに与えられた権限を実行できるようになる。

### ●IAMユーザ

AWSアカウント内に追加される利用ユーザ

AWS上の利用者はIAMユーザという権限を付与されたエンティティとして設定される

- 種類
1.  **ルートユーザ(IAMではない)** : AWSアカウント作成時に作られるIDアカウント。全てのAWSサービスとリソースをリソースを使用できる権限を有する。日常的なタスクはルートユーザを使用しないことが強く推奨される。

       **そのアカウント作成者 = ルートユーザ**

1. **管理者権限(IAMユーザ)** : 管理者権限の許可が付与されたIAMユーザのこと。IAM操作権限まであり。ルートアカウントしかできないルートアカウントしかできない権限は付与されない。
2. **パワーユーザ(IAMユーザ)** : IAM以外の全てのAWSサービスに降るアクセス権限を有するIAMユーザ。IAMの操作権限なし。

### ●IAMグループ

ユーザごとに権限を付与するのは、大変なので、「グループ」化して一元的に権限を管理できる。

グループには複数のIAMユーザが設定される。

**IAMリソース** : IAMで保存、管理されるユーザ、グループ、ロール、ポリシーおよびIDプロバイダー

**IAMアイデンティティ** : ユーザ、グループおよびロール。AWSで認証されてグループ化に使用されるIAMリソースオブジェクトのこと。

**IAMエンティティ** : ユーザよびロール。AWSに認証されるIAMリソースオブジェクト。

**プリンシパル** : **AWS リソースに対するアクションをリクエストできる**ルートユーザ、IAMユーザ、またはIAMロールを使用する人またはアプリケーションを指す。フェデレーションユーザと引き受けたロールも含まれる。
