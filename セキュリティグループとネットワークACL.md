⚠️**セキュリティグループやネットワークACLの設定を変更した場合、設定変更はすぐに適用される。**

**セキュリティグループ** : インスタンスへのトラフィックのアクセス可否を設定するファイアウォール機能を提供

- **インスタンス単位で適用**
- 特定のVPCに紐ついて作成
- **ステートフル** : インバウンドのみ設定すればアウトバウンドも設定される
- 許可のみをIn／outで設定
- **デフォルトでは全インバウンドが設定なし(暗黙の拒否設定)、アウトバウンドが許可される**
- 全てのルールを適用

**ネットワークACL(NACL)** : VPCとサブネットへのトラフィックのアクセス可否を設定するファイアウォール機能を提供

- **VPC/サブネット単位で適用**
- **ステートレス** : インバウンド設定だけではアウトバウンドアウトバウンドは許可されない
- 許可と拒否をIn/outで指定
- **デフォルトでは全ての通信を許可する設定**
- **番号の順番通りに適用するため、重複したプロトコルに設定されている場合は小さい番号が適用される。**

ネットワークのデフォルト構成はデフォルトとカスタムで異なる。

| VPCに最初に設定されるデフォルトNACL | ・全てのインバウンド全てのインバウンドトラフィックを許可する設定がされている
・全てのインバウンド全てのアウトバウンドトラフィックを許可する設定がされている |
| --- | --- |
| カスタムで作成するNACLのデフォルト設定 | ・全てのインバウンド全てのインバウンドトラフィックを拒否する設定がされている
・全てのインバウンド全てのアウトバウンドトラフィックを拒否する設定がされている |

**VPC内のリソースにアクセスする際はセキュリティグループセキュリティグループとネットワークACLの両方の許可設定が必要。**

Well-knownポート

| ポート番号 | プロトコル名 |
| --- | --- |
| 20 | FTP |
| 21 | FTP |
| 22 | SSH |
| 25 | SMTP |
| 53 | DNS |
| 80 | HTTP |
| 110 | POP3 |
| 443 | HTTPS |
| 3389 | Windowsサーバへのセキュアな接続を実施。リモートデスクトップリモートデスクトップによる接続を実施 |
| 3306 | DBインスタンスへのセキュアな接続を実施 |

エフェメラルポート : NACLを利用してサブネット内のリソースと通信をする際は特定ポート番号に加えエフェメラルポートの設定が必要。
